<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <!-- Content Security Policy: allow inline styles and scripts from https: -->
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'none'; style-src 'unsafe-inline' https:; script-src 'unsafe-inline' 'unsafe-eval';" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SVD Viewer</title>
    <!-- Bootstrap 5 CSS -->
    <link href="{{bootstrapUri}}" rel="stylesheet" />
    <style>
        /* Global dark theme with smaller text */
        html,
        body {
            background-color: #121212;
            color: #c0c0c0;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 0.85rem;
        }

        /* Card, alert, and form styling */
        .card,
        .alert {
            background-color: #1e1e1e;
            border: 1px solid #333;
            color: #c0c0c0;
        }

        .form-control {
            background-color: #1e1e1e;
            border: 1px solid #333;
            color: #c0c0c0;
        }

        //* Table styling: improved dark background with better contrast */
        .table {
            background-color: #1e1e1e !important;
            color: #c0c0c0;
            /* Brighter text for better readability */
            border-collapse: collapse;
            /* Removes extra spacing between cells */
            width: 100%;
        }

        /* Table headers with distinct visibility */
        .table th {
            background-color: #252525 !important;
            color: #ffffff;
            /* Ensures headers stand out */
            font-weight: bold;
            border-bottom: 2px solid #444;
            /* Subtle separator */
            padding: 8px;
        }

        /* Table body cells */
        .table td {
            background-color: #1e1e1e !important;
            color: #e0e0e0;
            /* Brighter text */
            padding: 8px;
            border: none;
            /* Remove default borders */
        }

        /* Zebra striping for alternate rows */
        .table tbody tr:nth-child(even) {
            background-color: #252525 !important;
        }

        /* Hover effect for rows */
        .table-hover tbody tr:hover {
            background-color: #333 !important;
        }

        /* Remove top border from first row */
        .table tbody tr:first-child td {
            border-top: none;
        }

        /* Scrollable container for the table */
        .table-responsive {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #333;
            /* Subtle outline for structure */
        }


        /* Dark theme for the file input button */
        input[type="file"] {
            background-color: #1e1e1e;
            border: 1px solid #333;
            color: #c0c0c0;
            padding: 8px;
        }

        /* Style the 'Choose Files' button */
        input[type="file"]::file-selector-button {
            background-color: #444;
            color: #fff;
            border: 1px solid #666;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
        }

        input[type="file"]::file-selector-button:hover {
            background-color: #555;
        }

        /* Modal styling adjustments */
        .modal-content {
            background-color: #1e1e1e;
            color: #c0c0c0;
        }

        /* Hide the default file input text preview */
        .file-input::-webkit-file-upload-button {
            visibility: hidden;
        }

        /* Custom styling for the file input button */
        .file-input {
            position: relative;
            overflow: hidden;
            width: 100%;
            padding: 10px;
            background-color: #222;
            color: #c0c0c0;
            border: 1px solid #444;
            border-radius: 5px;
            cursor: pointer;
        }

        /* Fake file upload button */
        .file-input::before {
            content: "Select Directory";
            display: inline-block;
            background-color: #444;
            color: #fff;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }

        /* Remove hover popup */
        .file-input:hover {
            background-color: #333;
        }

        .file-input:active::before {
            background-color: #555;
        }
    </style>
</head>

<body>
    <div class="container py-3">
        <h1 class="mb-4">SVD Viewer</h1>
        <div class="row">
            <!-- Left Column: File List -->
            <div class="col-md-4">
                <div class="mb-3">

                    <input class="form-control file-input" type="file" id="folderInput" webkitdirectory directory
                        multiple title="" />

                </div>
                <div class="card mb-3">
                    <div class="card-header">File List</div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0" id="filesTable">

                                <tbody>
                                    <!-- File rows will be inserted here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="selectedFile" class="alert alert-info" style="display: none;"></div>
            </div>
            <!-- Right Column: SVD Preview Placeholder -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">SVD Preview</div>
                    <div class="card-body" id="svdContent">
                        <p>Content of selected SVD file will appear here.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Bootstrap 5 JS Bundle (Optional if needed for interactive components) -->
    <script src="{{bootstrapBundleUri}}"></script>
    <script>
        // Acquire the VS Code API for message passing.
        const vscode = acquireVsCodeApi();

        const folderInput = document.getElementById('folderInput');
        const filesTableBody = document.querySelector('#filesTable tbody');
        const selectedFileDiv = document.getElementById('selectedFile');

        folderInput.addEventListener('change', (event) => {
            const files = event.target.files;
            // Clear previous rows
            filesTableBody.innerHTML = '';
            // Iterate over FileList and add rows for files ending with ".svd"
            for (const file of files) {
                if (!file.name.endsWith('.svd')) continue;
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.textContent = file.name;
                row.appendChild(cell);
                row.style.cursor = 'pointer';
                row.addEventListener('click', () => {
                    selectedFileDiv.textContent = "Selected file: " + file.name;
                    selectedFileDiv.style.display = 'block';
                    vscode.postMessage({ command: 'fileSelected', fileName: file.name });
                });
                filesTableBody.appendChild(row);
            }
        });
    </script>
</body>

</html>